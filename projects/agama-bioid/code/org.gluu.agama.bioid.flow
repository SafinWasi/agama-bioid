Flow org.gluu.agama.bioid
     Basepath ""
     Configs conf
bioid = Call org.gluu.agama.bioid.BioIdService#new conf
idp = Call org.gluu.agama.bioid.IdentityProcessor#new 
input = RRF "login.ftlh" 
login = Call idp authenticate input.username input.password
When login is false
     it_jbprl = {success:false, error: "Authentication failed"}
     Finish it_jbprl
enrolled = Call bioid isEnrolled input.username
When enrolled is false
     username = input.username
     return_url = conf.host
     enrollment_result = Trigger org.gluu.agama.bioid.enrollment bioid return_url username
     When enrollment_result.success is false
          it_gxlqu = {success:false, error: "Enrollment failed"}
          Finish it_gxlqu
Call bioid getBWSToken input.username "verify"
verify_token_map = {token:token, return_url: conf.host, state: "abcdef"}
verification_result = RRF "bioid.ftlh" verify_token_map true
When verification_result.error is null
     it_doppx = {success:true, data: { userId: input.username}}
     Finish it_doppx
verification_error = {success:true, data: {userId: input.username}}
Finish verification_error